<!-- @format -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>All Countermeasures</title>
    <!-- Bootstrap -->
    <link href="../css/bootstrap.min.css" rel="stylesheet" media="screen" />
    <link
      href="../css/bootstrap-theme.min.css"
      rel="stylesheet"
      media="screen"
    />
    <link
      href="../css/nchrp1441.css?v=20160525"
      rel="stylesheet"
      media="screen,print"
    />
    <link
      href="../css/nchrp1441-facility.css?v=20160525"
      rel="stylesheet"
      media="screen,print"
    />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans"
      rel="stylesheet"
      type="text/css"
      media="print"
    />
    <link
      href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/buttons/2.2.2/css/buttons.dataTables.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/fixedcolumns/4.0.1/css/fixedColumns.dataTables.min.css"
    />
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <!-- DataTables JavaScript -->
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/fixedcolumns/4.0.1/js/dataTables.fixedColumns.min.js"></script>
    <style>
      /* Custom CSS for DataTables sorting arrows with Font Awesome 4.4 */
      table.dataTable thead .sorting:after {
        content: "\25B2\25BC"; /* Add both up and down arrow symbols */
        font-family: Arial, sans-serif; /* Use standard font for arrows */
        opacity: 0.3;
        margin-left: 5px;
      }

      table.dataTable thead .sorting_asc:after {
        content: "\25B2"; /* Up arrow for ascending */
        opacity: 1;
      }

      table.dataTable thead .sorting_desc:after {
        content: "\25BC"; /* Down arrow for descending */
        opacity: 1;
      }
      /* CSS for text overflow with ellipsis */
      .text-overflow {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 120px;
        vertical-align: middle;
      }
      .pagination > .active > a {
        background-color: #4d6832 !important;
        border-color: #4d6832 !important;
        color: white !important;
      }
      .pagination > li > a,
      .pagination > li > span {
        color: #4d6832 !important;
      }
      /* Enable horizontal scrolling for DataTable */
      .dataTables_wrapper .dataTables_scroll {
        overflow-x: auto;
      }

      table.dataTable th {
        white-space: nowrap;
        font-size: 14px;
        text-align: center;
        vertical-align: middle;
        padding: 8px 10px;
        min-width: 100px;
      }

      table.dataTable td {
        white-space: nowrap;
        vertical-align: middle;
        padding: 6px 10px;
      }

      table.dataTable th:nth-child(1),
      table.dataTable td:nth-child(1) {
        min-width: 120px;
      }

      table.dataTable th:nth-child(2),
      table.dataTable td:nth-child(2) {
        min-width: 130px;
      }

      table.dataTable th:nth-child(3),
      table.dataTable td:nth-child(3) {
        min-width: 100px;
      }

      /* Style for pagination active button */
      .pagination > .active > a {
        background-color: #4d6832 !important;
        border-color: #4d6832 !important;
        color: white !important;
      }

      .pagination > li > a,
      .pagination > li > span {
        color: #4d6832 !important;
      }

      /* Custom styling for table borders to visually separate columns */
      table.dataTable tbody td {
        border-right: 1px solid #ddd;
      }

      table.dataTable thead th {
        border-right: 1px solid #ddd;
        background-color: #f8f8f8;
      }

      /* Add horizontal padding and adjust width of the DataTable container */
      .dataTables_wrapper {
        padding: 15px;
      }
      table.dataTable th:nth-child(1){
        z-index: 9999999;
      }

      /* .dataTables_length {
        display: inline-block;
      } */
      div.dataTables_wrapper div.dataTables_length label {
        color: #4d6832 !important;
      }
      button.dt-button, button.dt-button:hover {
        background-color: #4d6832 !important;
        color: white !important;
      }
      label {
        color: #4d6832 !important;
      }

      /* Change background color for the first column header (th) */
    table.dataTable thead tr > th:first-child,table.dataTable tbody tr > td:first-child {
        background-color:  #4d6832;
        color: white; 
    }

    </style>
  </head>
  <body class="facility">
    <header
      class="navbar navbar-static-top navbar-inverse"
      id="top"
      role="banner"
    >
      <div class="container v2">
        <div class="navbar-header">
          <button
            class="navbar-toggle collapsed"
            type="button"
            data-toggle="collapse"
            data-target=".bs-navbar-collapse"
          >
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a href="../index.htm" class="navbar-brand">NCHRP 17-113</a>
        </div>
        <nav class="collapse navbar-collapse bs-navbar-collapse">
          <ul class="nav navbar-nav">
            <li>
              <a href="../index.htm">Home</a>
            </li>
            <li>
              <a href="sd.htm">Knowledge Base</a>
            </li>
            <li class="active">
              <a href="tool2.html">Selection Tool</a>
            </li>
          </ul>
        </nav>
      </div>
      <!-- end .container -->
    </header>

    <!-- ************************************************************************************************* -->

    <div class="container">
      <h2 class="text-center">All Countermeasures</h2>
      <table
        id="countermeasuresTable"
        class="table table-striped table-bordered"
        style="width: 100%"
      >
        <thead>
          <tr>
            <th>Emphasis Area</th>
            <th>Target Crash Type</th>
            <th>Area Type</th>
            <th>Countermeasure</th>
            <th>Countermeasure Type</th>
            <th>CMF</th>
            <th>Crash Severity</th>
            <th>Road Type</th>
            <th>Star Quality</th>
            <th>Min AADT</th>
            <th>Max AADT</th>
            <th>Min Num Lanes</th>
            <th>Max Num Lane</th>
            <th>Cost</th>
            <th>Service Life</th>
            <th>Implementation Time</th>
            <th>Contributing Factors</th>
            <th>SSA Element</th>
            <th>SSA Hierarchy</th>
            <th>AASHTO</th>
            <th>Countermeasure Link</th>
            <th>Knowledge Base</th>
            <th>Countermeasure Factsheet</th>
            <th>Other Countermeasures</th>
            <th>NCHRP 500 Series Objective</th>
            <th>Image</th>
          </tr>
        </thead>
        <tbody>
          <!-- Data will be populated here by JavaScript -->
        </tbody>
      </table>
    </div>

    <script>
      $(document).ready(function () {
        const dataUrl =
          "https://raw.githubusercontent.com/Xatta-Trone/dummy-data-ait-lab/refs/heads/main/nchrp-17-113-countermeasure-v9-update-april-2025.json";
        const baseUrl = window.location.origin;

        // Fetch data and populate DataTable
        $.getJSON(dataUrl, function (data) {
          const tableData = data.map((item) => ({
            "Emphasis Area": item["Emphasis Area"],
            "Target Crash Type": item["Target Crash Type"],
            "Land Use Type": item["Land Use Type"],
            Countermeasure: item["Countermeasure"],
            "Countermeasure Type": item["Countermeasure Type"],
            CMF: item["CMF"],
            "Crash Severity": item["Crash Severity"],
            "Road Type": item["Road Type"],
            "Star Quality": renderStars(item["Star Quality"]),
            "Min AADT": item["Min AADT"],
            "Max AADT": item["Max AADT"],
            "Min Num Lanes": item["Min Num Lanes"],
            "Max Num Lane": item["Max Num Lane"],
            Cost: item["Cost"],
            "Service Life": item["Service Life"],
            "Implementation Time": item["Implementation Time"],
            "Contributing Factors": item["Contributing Factors"],
            "SSA Element": item["SSA Element"],
            "SSA Hierarchy": item["SSA Hierarchy"],
            AASHTO: item["AASHTO"],
            "Countermeasure Link": item["Countermeasure Link"],
            "Knowledge Base": item["Knowledge Base"],
            "Countermeasure Factsheet": item["Countermeasure Factsheet"],
            "Other Countermeasures": item["Other Countermeasures"],
            "NCHRP 500 Series Objective": item["NCHRP 500 Series Objective"] || "N/A",
            Image: item["img"]
              ? `<img src="${baseUrl}/core/images/countermeasures/${item["img"]}" alt="Countermeasure Image" style="width: 80px; height: auto;">`
              : "N/A",
          }));

          // Initialize DataTable with horizontal scrolling enabled
          $("#countermeasuresTable").DataTable({
            data: tableData,
            columns: [
              { data: "Emphasis Area" },
              { data: "Target Crash Type" },
              { data: "Land Use Type" },
              { data: "Countermeasure" },
              { data: "Countermeasure Type" },
              { data: "CMF" },
              { data: "Crash Severity" },
              { data: "Road Type" },
              { data: "Star Quality" },
              { data: "Min AADT" },
              { data: "Max AADT" },
              { data: "Min Num Lanes" },
              { data: "Max Num Lane" },
              { data: "Cost" },
              { data: "Service Life" },
              { data: "Implementation Time" },
              { data: "Contributing Factors" },
              { data: "SSA Element" },
              { data: "SSA Hierarchy" },
              { data: "AASHTO" },
              { data: "Countermeasure Link" },
              { data: "Knowledge Base" },
              { data: "Countermeasure Factsheet" },
              { data: "Other Countermeasures" },
              { data: "NCHRP 500 Series Objective" },
              { data: "Image" },
            ],
            scrollX: true, // Enable horizontal scrolling
            pageLength: 10,
            autoWidth: true,
            lengthMenu: [5, 10, 25, 50, 100],
            fixedColumns: true,
            order: [[0, "asc"]],
            dom: "lBfrtip", // Enables the buttons at the top
            buttons: [
              {
                extend: "csv",
                text: "CSV",
              },
              {
                extend: "excel",
                text: "Excel",
              },
              {
                extend: "print",
                text: "Print",
              },
            ],
            fixedColumns: {
              leftColumns: 1, // Fix the first column
            },
          });
        });

        // Function to render stars with different shades of gold
        function renderStars(rating) {
          rating = parseInt(rating || 0);
          const goldShades = [
            "#FFD700",
            "#FFC700",
            "#FFB700",
            "#FFA700",
            "#FF9700",
          ];
          let stars = "";
          for (let i = 0; i < rating; i++) {
            const color = goldShades[i] || goldShades[goldShades.length - 1];
            stars += `<i class="fa fa-star" style="color: ${color};"></i>`;
          }
          return stars || "N/A";
        }
      });
    </script>
  </body>
</html>
